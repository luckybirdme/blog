---
title: Redis 问题
date: 2020-04-11 20:31:41
tags: Redis
---

> 本文基于 Redis 4.0 版本

<!-- more -->


## 一. 缓存穿透
##### 1. 触发场景
key对应的数据在数据源并不存在，每次针对此key的请求从缓存获取不到，请求都会穿透到数据源，从而可能压垮数据源。比如用一个不存在的用户id获取用户信息，不论缓存还是数据库都没有，若黑客利用此漏洞进行攻击可能压垮数据库。

##### 2. 解决方法
如果数据源查询返回的数据为空，不管是数据不存在，还是系统故障，我们仍然把这个空结果进行缓存，但它的过期时间会很短，最长不超过五分钟。

## 二. 缓存击穿
##### 1. 触发场景
key对应的数据存在，但在redis中过期，此时若有大量并发请求过来，这些请求发现缓存过期一般都会从后端DB加载数据并回设到缓存，这个时候大并发的请求可能会瞬间把后端DB压垮。
##### 2. 解决方法
设置缓存value永不过期，当需要更新缓存时，在请求量小的时候手动更新

## 三. 缓存雪崩
##### 1. 触发场景 
当缓存服务器重启或者大量缓存集中在某一个时间段失效，这样在失效的时候，也会给后端系统(比如DB)带来很大压力。
##### 2. 解决方法
缓存过期时间添加随机数，比如1-10分钟，避免同时大批量失效


