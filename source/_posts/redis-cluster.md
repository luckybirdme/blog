---
title: Redis 集群
date: 2020-04-11 10:33:05
tags: Redis
---

> 本文基于 Redis 4.0 版本


<!-- more -->

## 一. 面临情况
##### 1. 一台机器无法容纳当前数据量
##### 2. 单机性能无法满足当前的请求量
##### 3. 单机出现故障无法确保数据高可用

## 二. Redis 集群原理 
##### 1. 根据哈希槽，每个Key采用CRC16校验后对16384取模，自动分割数据到不同的节点上，达到数据扩容，且负载均衡。

![](http://qiniucdn.luckybird.me/blog/img/2020/Redis_cluster_slot.jpg)


##### 2. 利用主从同步，最基本三个 master 三个 slave，当主节点单机，从节点顶上，依然能够继续使用，确保集群高可用。

![](http://qiniucdn.luckybird.me/blog/img/2020/Redis_cluster_master_client.jpg)


## 三. 优缺点
##### 1. 优点
- 根据不同哈希槽位，进行数据自动分片，便于动态扩容
- 节点出现故障，集群自动切换，确保数据高可用

##### 2. 缺点
- 节点故障时，无法确保数据一致性
- 集群部署相对复杂
- 从节点空闲浪费
